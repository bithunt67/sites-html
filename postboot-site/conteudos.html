<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostBoot - Conteúdos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- Font Awesome para ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            padding-top: 60px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .card {
            background: #ffffff;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: border-color 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: #007bff;
            box-shadow: 0 0 8px rgba(0, 123, 255, 0.3);
        }

        .btn {
            border-radius: 10px;
            padding: 12px 20px;
            font-weight: 600;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-primary {
            background: linear-gradient(45deg, #007bff, #00c4ff);
        }

        .text-primary {
            color: #007bff !important;
        }

        h1, h2 {
            letter-spacing: 1px;
        }

        .schedule-options {
            display: none; /* Escondido por padrão */
        }

        .schedule-options.active {
            display: block; /* Mostra quando ativo */
        }
    </style>
</head>
<body class="bg-light">
    <div id="navbar-placeholder"></div>
    <div class="container mt-5 d-flex justify-content-center align-items-center min-vh-100">
        <div class="card shadow-lg p-4 rounded-3 border-0" style="width: 100%; max-width: 600px;">
            <h1 class="text-center mb-4 fw-bold text-primary">Conteúdos</h1>
            <h2 class="text-center mb-4 text-muted fs-4">Cadastrar Publicação</h2>
            <form id="contentForm" onsubmit="submitContent(event)">
                <!-- Título -->
                <div class="mb-3">
                    <label for="titulo" class="form-label fw-semibold">Título</label>
                    <input type="text" id="titulo" name="titulo" class="form-control form-control-lg shadow-sm" placeholder="Digite o título..." required>
                </div>
                <!-- Descrição -->
                <div class="mb-3">
                    <label for="descricao" class="form-label fw-semibold">Descrição</label>
                    <textarea id="descricao" name="descricao" class="form-control shadow-sm" rows="3" placeholder="Digite a descrição..." required></textarea>
                </div>
                <!-- URL do Vídeo ou Foto -->
                <div class="mb-3">
                    <label for="url" class="form-label fw-semibold">URL do Vídeo ou Foto</label>
                    <input type="url" id="url" name="url" class="form-control shadow-sm" placeholder="https://exemplo.com/video.mp4" required>
                </div>
                <!-- Agendamento -->
                <div class="mb-4">
                    <label class="form-label fw-semibold">Agendamento</label>
                    <div class="mb-2">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="schedule_type" id="daily" value="daily" checked onchange="toggleScheduleOptions()">
                            <label class="form-check-label" for="daily">Todos os dias</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="schedule_type" id="specific" value="specific" onchange="toggleScheduleOptions()">
                            <label class="form-check-label" for="specific">Dia específico</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="schedule_type" id="weekdays" value="weekdays" onchange="toggleScheduleOptions()">
                            <label class="form-check-label" for="weekdays">Apenas dias úteis</label>
                        </div>
                    </div>
                    <!-- Opções de agendamento dinâmicas -->
                    <div id="daily-options" class="schedule-options active">
                        <label for="daily_time" class="form-label">Horário</label>
                        <input type="time" id="daily_time" name="daily_time" class="form-control shadow-sm" required>
                    </div>
                    <div id="specific-options" class="schedule-options">
                        <label for="specific_datetime" class="form-label">Data e Horário</label>
                        <input type="datetime-local" id="specific_datetime" name="specific_datetime" class="form-control shadow-sm">
                    </div>
                    <div id="weekdays-options" class="schedule-options">
                        <label for="weekdays_time" class="form-label">Horário</label>
                        <input type="time" id="weekdays_time" name="weekdays_time" class="form-control shadow-sm">
                    </div>
                </div>
                <!-- Botão de Enviar -->
                <div class="d-grid">
                    <button type="submit" class="btn btn-primary btn-lg shadow-sm d-flex align-items-center justify-content-center">
                        <i class="fas fa-upload me-2"></i> Cadastrar Publicação
                    </button>
                </div>
            </form>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/script.js"></script>
    <script>
        fetch('components/navbar.html')
            .then(response => response.text())
            .then(data => document.getElementById('navbar-placeholder').innerHTML = data);

        function toggleScheduleOptions() {
            const scheduleType = document.querySelector('input[name="schedule_type"]:checked').value;
            document.querySelectorAll('.schedule-options').forEach(option => {
                option.classList.remove('active');
            });
            document.getElementById(`${scheduleType}-options`).classList.add('active');
        }

        function submitContent(event) {
            event.preventDefault();
            const form = document.getElementById('contentForm');
            const formData = new FormData(form);
            const contentData = Object.fromEntries(formData.entries());
            const scheduleType = contentData.schedule_type;

            // Ajustar os dados de agendamento com base no tipo
            let schedule;
            if (scheduleType === 'daily') {
                schedule = { type: 'daily', time: contentData.daily_time };
            } else if (scheduleType === 'specific') {
                schedule = { type: 'specific', datetime: contentData.specific_datetime };
            } else if (scheduleType === 'weekdays') {
                schedule = { type: 'weekdays', time: contentData.weekdays_time };
            }

            // Dados finais para envio
            const dataToSend = {
                titulo: contentData.titulo,
                descricao: contentData.descricao,
                url: contentData.url,
                schedule: schedule
            };

            fetch('https://n8n.witicket.com.br/webhook-test/dbffcf23-4bb7-47b4-970c-994aa42b149c', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(dataToSend),
            })
            .then(response => {
                if (response.ok) {
                    alert('Conteúdo cadastrado com sucesso!');
                    form.reset();
                    toggleScheduleOptions(); // Reseta as opções de agendamento
                } else {
                    alert('Erro ao cadastrar conteúdo. Tente novamente.');
                }
            })
            .catch(error => {
                console.error('Erro:', error);
                alert('Erro ao conectar ao servidor.');
            });
        }
    </script>
</body>
</html>